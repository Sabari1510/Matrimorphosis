<app-navbar></app-navbar>

<div class="resident-dashboard">
    <div class="dashboard-container">
        <!-- Header Section -->
        <div class="dashboard-header">
            <div class="welcome-section">
                <h1>Welcome Back, <span class="accent">{{ userName }}</span></h1>
                <p>Manage your maintenance requests</p>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <div class="action-card" (click)="openNewRequestModal()">
                <div class="action-icon new-request">â•</div>
                <h3 class="action-title">New Request</h3>
                <p class="action-description">Submit a maintenance request</p>
            </div>

            <div class="action-card" (click)="trackRequests()">
                <div class="action-icon track">ğŸ“</div>
                <h3 class="action-title">Track Requests</h3>
                <p class="action-description">View request status</p>
            </div>

            <div class="action-card" (click)="viewHistory()">
                <div class="action-icon history">ğŸ“œ</div>
                <h3 class="action-title">History</h3>
                <p class="action-description">View past requests</p>
            </div>

            <div class="action-card" (click)="contactSupport()">
                <div class="action-icon contact">ğŸ“</div>
                <h3 class="action-title">Contact</h3>
                <p class="action-description">Get help</p>
            </div>
        </div>

        <!-- Overview Section -->
        <div class="overview-section">
            <!-- Recent Requests -->
            <div class="requests-section">
                <div class="section-header">
                    <h2 class="section-title">Recent Requests</h2>
                    <a routerLink="/maintenance/history" class="view-all-link">View All â†’</a>
                </div>

                <div class="request-card" *ngFor="let request of requests.slice(0, 5)" [ngClass]="request.priority"
                    (click)="viewRequestDetails(request)">
                    <div class="request-header">
                        <span class="request-id">#{{ request.id }}</span>
                        <span class="request-status" [ngClass]="request.status">{{ request.status }}</span>
                    </div>
                    <h4 class="request-title">{{ request.title }}</h4>
                    <p class="request-date">{{ request.created_at | date:'medium' }}</p>
                </div>

                <!-- Request Detail Modal -->
                <app-request-modal *ngIf="selectedRequest" [request]="selectedRequest" [userRole]="'Resident'"
                    [userId]="userId" (close)="closeRequestModal()" (updated)="loadRequests()">
                </app-request-modal>

                <!-- Empty State -->
                <div class="empty-state" *ngIf="requests.length === 0">
                    <div class="empty-state-icon">ğŸ“­</div>
                    <h3>No Requests Yet</h3>
                    <p>You haven't submitted any maintenance requests.</p>
                </div>
            </div>

            <!-- Stats Sidebar -->
            <div class="stats-sidebar">
                <div class="stats-card">
                    <h3 class="section-title">Overview</h3>
                    <div class="stat-item">
                        <span class="stat-label">Total Requests</span>
                        <span class="stat-value">{{ stats.total }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Pending</span>
                        <span class="stat-value highlight">{{ stats.pending }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">In Progress</span>
                        <span class="stat-value">{{ stats.inProgress }}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Completed</span>
                        <span class="stat-value">{{ stats.completed }}</span>
                    </div>
                </div>

                <!-- Contact Card -->
                <div class="contact-card">
                    <h3>Need Help?</h3>
                    <div class="contact-info">
                        <div class="contact-item">
                            <span>ğŸ“</span>
                            <span>+1 (555) 123-4567</span>
                        </div>
                        <div class="contact-item">
                            <span>ğŸ“§</span>
                            <span>support&#64;maintenance.com</span>
                        </div>
                    </div>
                    <button class="contact-btn" (click)="contactSupport()">Contact Support</button>
                </div>
            </div>
        </div>
    </div>
</div>