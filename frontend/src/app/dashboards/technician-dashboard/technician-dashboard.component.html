<app-navbar></app-navbar>

<div class="technician-dashboard">
    <div class="dashboard-container">
        <!-- Header Section -->
        <div class="dashboard-header">
            <div class="header-content">
                <div class="welcome-section">
                    <h1>Welcome, <span class="accent">{{ userName }}!</span></h1>
                    <div class="subtitle-row">
                        <p>Manage your assigned work orders</p>
                        <span class="specialization-badge" *ngIf="specialization">
                            {{ specialization | titlecase }} Specialist
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon assigned">ğŸ“‹</div>
                <div class="stat-value">{{ stats.myTasks }}</div>
                <div class="stat-label">Assigned Tasks</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon completed">âœ…</div>
                <div class="stat-value">{{ stats.completedToday }}</div>
                <div class="stat-label">Completed Today</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon pending">â°</div>
                <div class="stat-value">{{ stats.pending }}</div>
                <div class="stat-label">Pending Tasks</div>
            </div>
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <h3 class="filter-header">Filter Work Orders</h3>
            <div class="filter-pills">
                <button class="filter-pill active">All</button>
                <button class="filter-pill">Pending</button>
                <button class="filter-pill">In Progress</button>
                <button class="filter-pill">Completed</button>
                <button class="filter-pill">High Priority</button>
            </div>
        </div>

        <!-- Work Orders Grid -->
        <div class="work-orders-grid">
            <div class="work-order-card" *ngFor="let order of filteredWorkOrders" [ngClass]="order.priority">
                <div class="order-header">
                    <span class="order-id">#{{ order.id }}</span>
                    <span class="order-priority" [ngClass]="order.priority">{{ order.priority }}</span>
                </div>

                <h3 class="order-title">{{ order.title }}</h3>
                <p class="order-description">{{ order.description }}</p>

                <div class="order-meta">
                    <span>ğŸ“ {{ order.location }}</span>
                    <span>ğŸ“… {{ order.created_at | date:'short' }}</span>
                </div>

                <span class="order-status" [ngClass]="order.status">{{ order.status }}</span>

                <div class="order-actions">
                    <button class="btn btn-primary" (click)="startWork(order)" *ngIf="order.status === 'Assigned'">
                        Start Work
                    </button>
                    <button class="btn btn-primary" *ngIf="order.status === 'In-Progress'"
                        (click)="viewWorkOrder(order)">
                        Mark Complete
                    </button>
                    <button class="btn btn-secondary" (click)="viewWorkOrder(order)">
                        View Details
                    </button>
                </div>
            </div>

            <!-- Request Detail Modal -->
            <app-request-modal *ngIf="selectedWorkOrder" [request]="selectedWorkOrder" [userRole]="'Technician'"
                [userId]="userId" (close)="closeModal()" (updated)="loadData()">
            </app-request-modal>

            <!-- Empty State -->
            <div class="empty-state" *ngIf="filteredWorkOrders.length === 0">
                <div class="empty-state-icon">ğŸ“­</div>
                <h3>No Work Orders</h3>
                <p>You don't have any work orders matching the current filter.</p>
            </div>
        </div>
    </div>
</div>